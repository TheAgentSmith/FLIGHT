#include "Sky.hpp"

static const float skyDome[] = {
    0.038060, 0.980785, -0.191342,
    0.074658, 0.923880, -0.375330,
    0.108386, 0.831470, -0.544895,
    0.137950, 0.707107, -0.693520,
    0.162212, 0.555570, -0.815493,
    0.180240, 0.382683, -0.906127,
    0.191342, 0.195090, -0.961940,
    0.195090, 0.000000, -0.980785,
    0.074658, 0.980785, -0.180240,
    0.146447, 0.923880, -0.353553,
    0.212608, 0.831470, -0.513280,
    0.270598, 0.707107, -0.653281,
    0.318190, 0.555570, -0.768178,
    0.353553, 0.382683, -0.853553,
    0.375330, 0.195090, -0.906127,
    0.382684, 0.000000, -0.923879,
    0.108387, 0.980785, -0.162212,
    0.212608, 0.923880, -0.318190,
    0.308658, 0.831470, -0.461940,
    0.392848, 0.707107, -0.587938,
    0.461940, 0.555570, -0.691342,
    0.513280, 0.382683, -0.768178,
    0.544895, 0.195090, -0.815493,
    0.555570, 0.000000, -0.831469,
    0.137950, 0.980785, -0.137950,
    0.270598, 0.923880, -0.270598,
    0.392848, 0.831470, -0.392847,
    0.500000, 0.707107, -0.500000,
    0.587938, 0.555570, -0.587938,
    0.653282, 0.382683, -0.653281,
    0.693520, 0.195090, -0.693520,
    0.707107, 0.000000, -0.707107,
    0.162212, 0.980785, -0.108386,
    0.318190, 0.923880, -0.212607,
    0.461940, 0.831470, -0.308658,
    0.587938, 0.707107, -0.392847,
    0.691342, 0.555570, -0.461940,
    0.768178, 0.382683, -0.513280,
    0.815493, 0.195090, -0.544895,
    0.831470, 0.000000, -0.555570,
    0.180240, 0.980785, -0.074658,
    0.353554, 0.923880, -0.146446,
    0.513280, 0.831470, -0.212607,
    0.653282, 0.707107, -0.270598,
    0.768178, 0.555570, -0.318189,
    0.853554, 0.382683, -0.353553,
    0.906128, 0.195090, -0.375330,
    0.923880, 0.000000, -0.382683,
    0.191342, 0.980785, -0.038060,
    0.375331, 0.923880, -0.074658,
    0.544895, 0.831470, -0.108386,
    0.693520, 0.707107, -0.137949,
    0.815493, 0.555570, -0.162211,
    0.906128, 0.382683, -0.180240,
    0.961940, 0.195090, -0.191341,
    0.980785, 0.000000, -0.195090,
    0.195091, 0.980785, 0.000000,
    0.382684, 0.923880, 0.000000,
    0.555570, 0.831470, 0.000000,
    0.707107, 0.707107, 0.000000,
    0.831470, 0.555570, 0.000000,
    0.923880, 0.382683, 0.000000,
    0.980785, 0.195090, 0.000000,
    1.000000, 0.000000, 0.000000,
    -0.000000, 1.000000, 0.000001,
    -0.195090, 0.980785, 0.000000,
    -0.382683, 0.923880, 0.000000,
    -0.555570, 0.831470, 0.000000,
    -0.707107, 0.707107, 0.000000,
    -0.831469, 0.555570, 0.000000,
    -0.923879, 0.382683, 0.000000,
    -0.980785, 0.195090, 0.000000,
    -1.000000, 0.000000, 0.000000,
    -0.191342, 0.980785, -0.038060,
    -0.375330, 0.923880, -0.074658,
    -0.544895, 0.831470, -0.108386,
    -0.693520, 0.707107, -0.137949,
    -0.815493, 0.555570, -0.162211,
    -0.906127, 0.382683, -0.180240,
    -0.961939, 0.195090, -0.191342,
    -0.980785, 0.000000, -0.195090,
    -0.180240, 0.980785, -0.074658,
    -0.353553, 0.923880, -0.146446,
    -0.513280, 0.831470, -0.212607,
    -0.653281, 0.707107, -0.270598,
    -0.768177, 0.555570, -0.318189,
    -0.853553, 0.382683, -0.353553,
    -0.906127, 0.195090, -0.375330,
    -0.923879, 0.000000, -0.382683,
    -0.162212, 0.980785, -0.108386,
    -0.318190, 0.923880, -0.212607,
    -0.461940, 0.831470, -0.308658,
    -0.587938, 0.707107, -0.392847,
    -0.691341, 0.555570, -0.461939,
    -0.768178, 0.382683, -0.513280,
    -0.815493, 0.195090, -0.544895,
    -0.831469, 0.000000, -0.555570,
    -0.137950, 0.980785, -0.137949,
    -0.270598, 0.923880, -0.270598,
    -0.392847, 0.831470, -0.392847,
    -0.500000, 0.707107, -0.500000,
    -0.587937, 0.555570, -0.587937,
    -0.653281, 0.382683, -0.653281,
    -0.693519, 0.195090, -0.693519,
    -0.707106, 0.000000, -0.707106,
    -0.108386, 0.980785, -0.162211,
    -0.212607, 0.923880, -0.318189,
    -0.308658, 0.831470, -0.461939,
    -0.392847, 0.707107, -0.587937,
    -0.461939, 0.555570, -0.691341,
    -0.513280, 0.382683, -0.768177,
    -0.544895, 0.195090, -0.815492,
    -0.555570, 0.000000, -0.831469,
    -0.074658, 0.980785, -0.180240,
    -0.146447, 0.923880, -0.353553,
    -0.212607, 0.831470, -0.513280,
    -0.270598, 0.707107, -0.653281,
    -0.318189, 0.555570, -0.768177,
    -0.353553, 0.382683, -0.853553,
    -0.375330, 0.195090, -0.906127,
    -0.382683, 0.000000, -0.923879,
    -0.038060, 0.980785, -0.191342,
    -0.074658, 0.923880, -0.375330,
    -0.108386, 0.831470, -0.544895,
    -0.137950, 0.707107, -0.693520,
    -0.162211, 0.555570, -0.815492,
    -0.180240, 0.382683, -0.906127,
    -0.191341, 0.195090, -0.961939,
    -0.195090, 0.000000, -0.980785,
};

SkyManager::SkyManager() {
    glGenBuffers(1, &m_vbo);
    glBindBuffer(GL_ARRAY_BUFFER, m_vbo);
    glBufferData(GL_ARRAY_BUFFER, sizeof(skyDome), skyDome, GL_STATIC_DRAW);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
}

void SkyManager::Display(const GLuint shaderProgram) {
    glBindBuffer(GL_ARRAY_BUFFER, m_vbo);
    GLint posLoc = glGetAttribLocation(shaderProgram, "position");
    glVertexAttribPointer(posLoc, 3, GL_FLOAT, GL_FALSE, 0, 0);
    glm::mat4 model;
    GLint modelLoc = glGetUniformLocation(shaderProgram, "model");
    glUniformMatrix4fv(modelLoc, 1, GL_FALSE, glm::value_ptr(model));
    glBindBuffer(GL_ARRAY_BUFFER, 0);
}
